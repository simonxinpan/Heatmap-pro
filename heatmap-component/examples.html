<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çƒ­åŠ›å›¾ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .example-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .example-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }
        
        .example-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .heatmap-container {
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 15px 0;
            min-height: 300px;
            position: relative;
        }
        
        .controls {
            margin: 15px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0056b3;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #545b62;
        }
        
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”¥ çƒ­åŠ›å›¾ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹</h1>
            <p>å±•ç¤ºå¦‚ä½•åœ¨ä¸åŒåœºæ™¯ä¸‹ä½¿ç”¨å¯ç§»æ¤çš„è‚¡ç¥¨çƒ­åŠ›å›¾ç»„ä»¶</p>
        </div>
        
        <!-- ç¤ºä¾‹1ï¼šå…¨æ™¯çƒ­åŠ›å›¾ -->
        <div class="example-section">
            <div class="example-title">ğŸ“Š å…¨æ™¯çƒ­åŠ›å›¾ (Panoramic Heatmap)</div>
            <div class="example-description">
                é€‚ç”¨äºä¸»é¡µé¢æˆ–ä»ªè¡¨æ¿ï¼Œæ˜¾ç¤ºæ•´ä¸ªå¸‚åœºçš„è‚¡ç¥¨è¡¨ç°æ¦‚è§ˆã€‚
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" onclick="loadPanoramicData()">åŠ è½½å¸‚åœºæ•°æ®</button>
                <button class="btn btn-secondary" onclick="changePanoramicMetric('volume')">åˆ‡æ¢åˆ°æˆäº¤é‡</button>
                <button class="btn btn-secondary" onclick="changePanoramicMetric('changePercent')">åˆ‡æ¢åˆ°æ¶¨è·Œå¹…</button>
                <button class="btn btn-secondary" onclick="exportPanoramic()">å¯¼å‡ºå›¾ç‰‡</button>
            </div>
            
            <div id="panoramic-heatmap" class="heatmap-container"></div>
            
            <div class="code-block">
// åˆ›å»ºå…¨æ™¯çƒ­åŠ›å›¾
const panoramicHeatmap = createPanoramicHeatmap('panoramic-heatmap', {
    onStockClick: (stock) => {
        console.log('ç‚¹å‡»è‚¡ç¥¨:', stock);
        alert(`ç‚¹å‡»äº† ${stock.name || stock.symbol}`);
    }
});

// åŠ è½½æ•°æ®
panoramicHeatmap.loadMarketData();
            </div>
        </div>
        
        <!-- ç¤ºä¾‹2ï¼šè¡Œä¸šçƒ­åŠ›å›¾ -->
        <div class="example-section">
            <div class="example-title">ğŸ­ è¡Œä¸šçƒ­åŠ›å›¾ (Sector Heatmap)</div>
            <div class="example-description">
                æ˜¾ç¤ºç‰¹å®šè¡Œä¸šå†…è‚¡ç¥¨çš„è¡¨ç°ï¼Œé€‚ç”¨äºè¡Œä¸šåˆ†æé¡µé¢ã€‚
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" onclick="loadSectorData('ç§‘æŠ€')">ç§‘æŠ€è¡Œä¸š</button>
                <button class="btn btn-primary" onclick="loadSectorData('é‡‘è')">é‡‘èè¡Œä¸š</button>
                <button class="btn btn-primary" onclick="loadSectorData('åŒ»ç–—')">åŒ»ç–—è¡Œä¸š</button>
                <button class="btn btn-secondary" onclick="refreshSector()">åˆ·æ–°æ•°æ®</button>
            </div>
            
            <div id="sector-heatmap" class="heatmap-container"></div>
            
            <div class="code-block">
// åˆ›å»ºè¡Œä¸šçƒ­åŠ›å›¾
const sectorHeatmap = createHeatmap('sector-heatmap', {
    width: 800,
    height: 400,
    showLabels: true,
    onStockClick: (stock) => {
        // è·³è½¬åˆ°è‚¡ç¥¨è¯¦æƒ…é¡µ
        window.open(`/stock-detail.html?symbol=${stock.symbol}`, '_blank');
    }
});

// åŠ è½½ç‰¹å®šè¡Œä¸šæ•°æ®
sectorHeatmap.loadSectorData('ç§‘æŠ€');
            </div>
        </div>
        
        <!-- ç¤ºä¾‹3ï¼šæ ‡ç­¾çƒ­åŠ›å›¾ -->
        <div class="example-section">
            <div class="example-title">ğŸ·ï¸ æ ‡ç­¾çƒ­åŠ›å›¾ (Tag Heatmap)</div>
            <div class="example-description">
                åŸºäºæ ‡ç­¾åˆ†ç±»æ˜¾ç¤ºè‚¡ç¥¨ï¼Œé€‚ç”¨äºä¸»é¢˜æŠ•èµ„æˆ–æ¦‚å¿µè‚¡åˆ†æã€‚
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" onclick="loadTagData('äººå·¥æ™ºèƒ½')">äººå·¥æ™ºèƒ½</button>
                <button class="btn btn-primary" onclick="loadTagData('æ–°èƒ½æº')">æ–°èƒ½æº</button>
                <button class="btn btn-primary" onclick="loadTagData('èŠ¯ç‰‡')">èŠ¯ç‰‡æ¦‚å¿µ</button>
                <button class="btn btn-secondary" onclick="refreshTag()">åˆ·æ–°æ•°æ®</button>
            </div>
            
            <div id="tag-heatmap" class="heatmap-container"></div>
            
            <div class="code-block">
// åˆ›å»ºæ ‡ç­¾çƒ­åŠ›å›¾
const tagHeatmap = createHeatmap('tag-heatmap', {
    width: 800,
    height: 400,
    colorScheme: 'greenRed',
    animation: true
});

// åŠ è½½æ ‡ç­¾æ•°æ®
tagHeatmap.loadTagData('äººå·¥æ™ºèƒ½');
            </div>
        </div>
        
        <!-- ç¤ºä¾‹4ï¼šç´§å‡‘å‹çƒ­åŠ›å›¾ -->
        <div class="example-section">
            <div class="example-title">ğŸ“± ç´§å‡‘å‹çƒ­åŠ›å›¾ (Compact Heatmap)</div>
            <div class="example-description">
                é€‚ç”¨äºä¾§è¾¹æ ã€å¡ç‰‡æˆ–ç§»åŠ¨ç«¯æ˜¾ç¤ºï¼Œå ç”¨ç©ºé—´è¾ƒå°ä½†ä¿¡æ¯ä¸°å¯Œã€‚
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" onclick="loadCompactData('gainers')">æ¶¨å¹…æ¦œ</button>
                <button class="btn btn-primary" onclick="loadCompactData('losers')">è·Œå¹…æ¦œ</button>
                <button class="btn btn-primary" onclick="loadCompactData('active')">æ´»è·ƒè‚¡</button>
            </div>
            
            <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                <div id="compact-heatmap-1" class="heatmap-container" style="width: 350px; height: 250px;"></div>
                <div id="compact-heatmap-2" class="heatmap-container" style="width: 350px; height: 250px;"></div>
            </div>
            
            <div class="code-block">
// åˆ›å»ºç´§å‡‘å‹çƒ­åŠ›å›¾
const compactHeatmap1 = createCompactHeatmap('compact-heatmap-1');
const compactHeatmap2 = createCompactHeatmap('compact-heatmap-2');

// åŠ è½½ä¸åŒç±»å‹çš„æ•°æ®
compactHeatmap1.loadTrendingData('gainers');
compactHeatmap2.loadTrendingData('losers');
            </div>
        </div>
        
        <!-- ç¤ºä¾‹5ï¼šè¿·ä½ çƒ­åŠ›å›¾ -->
        <div class="example-section">
            <div class="example-title">ğŸ” è¿·ä½ çƒ­åŠ›å›¾ (Mini Heatmap)</div>
            <div class="example-description">
                æœ€å°åŒ–çš„çƒ­åŠ›å›¾ï¼Œé€‚ç”¨äºä»ªè¡¨æ¿å°éƒ¨ä»¶æˆ–å¿«é€Ÿé¢„è§ˆã€‚
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" onclick="loadMiniData()">åŠ è½½æ•°æ®</button>
                <button class="btn btn-secondary" onclick="toggleMiniAnimation()">åˆ‡æ¢åŠ¨ç”»</button>
            </div>
            
            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                <div id="mini-heatmap-1" class="heatmap-container" style="width: 200px; height: 150px;"></div>
                <div id="mini-heatmap-2" class="heatmap-container" style="width: 200px; height: 150px;"></div>
                <div id="mini-heatmap-3" class="heatmap-container" style="width: 200px; height: 150px;"></div>
            </div>
            
            <div class="code-block">
// åˆ›å»ºè¿·ä½ çƒ­åŠ›å›¾
const miniHeatmap1 = createMiniHeatmap('mini-heatmap-1');
const miniHeatmap2 = createMiniHeatmap('mini-heatmap-2');
const miniHeatmap3 = createMiniHeatmap('mini-heatmap-3');

// åŠ è½½ä¸åŒæ•°æ®
miniHeatmap1.loadSectorData('ç§‘æŠ€');
miniHeatmap2.loadSectorData('é‡‘è');
miniHeatmap3.loadSectorData('åŒ»ç–—');
            </div>
        </div>
        
        <!-- çŠ¶æ€æ˜¾ç¤º -->
        <div id="status-container"></div>
    </div>
    
    <!-- å¼•å…¥ç»„ä»¶æ–‡ä»¶ -->
    <script src="config.js"></script>
    <script src="DataProcessor.js"></script>
    <script src="StockHeatmap.js"></script>
    <script src="HeatmapRenderer.js"></script>
    <script src="index.js"></script>
    
    <script>
        // å…¨å±€å˜é‡å­˜å‚¨ç»„ä»¶å®ä¾‹
        let panoramicHeatmap, sectorHeatmap, tagHeatmap;
        let compactHeatmap1, compactHeatmap2;
        let miniHeatmap1, miniHeatmap2, miniHeatmap3;
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeHeatmaps();
        });
        
        function initializeHeatmaps() {
            try {
                // åˆå§‹åŒ–å…¨æ™¯çƒ­åŠ›å›¾
                panoramicHeatmap = createPanoramicHeatmap('panoramic-heatmap', {
                    onStockClick: (stock) => {
                        showStatus(`ç‚¹å‡»äº†è‚¡ç¥¨: ${stock.name || stock.symbol}`, 'success');
                    },
                    onStockHover: (stock) => {
                        console.log('æ‚¬åœè‚¡ç¥¨:', stock);
                    }
                });
                
                // åˆå§‹åŒ–è¡Œä¸šçƒ­åŠ›å›¾
                sectorHeatmap = createHeatmap('sector-heatmap', {
                    width: 800,
                    height: 400,
                    showLabels: true,
                    onStockClick: (stock) => {
                        showStatus(`æŸ¥çœ‹è‚¡ç¥¨è¯¦æƒ…: ${stock.name || stock.symbol}`, 'success');
                    }
                });
                
                // åˆå§‹åŒ–æ ‡ç­¾çƒ­åŠ›å›¾
                tagHeatmap = createHeatmap('tag-heatmap', {
                    width: 800,
                    height: 400,
                    colorScheme: 'greenRed',
                    animation: true
                });
                
                // åˆå§‹åŒ–ç´§å‡‘å‹çƒ­åŠ›å›¾
                compactHeatmap1 = createCompactHeatmap('compact-heatmap-1');
                compactHeatmap2 = createCompactHeatmap('compact-heatmap-2');
                
                // åˆå§‹åŒ–è¿·ä½ çƒ­åŠ›å›¾
                miniHeatmap1 = createMiniHeatmap('mini-heatmap-1');
                miniHeatmap2 = createMiniHeatmap('mini-heatmap-2');
                miniHeatmap3 = createMiniHeatmap('mini-heatmap-3');
                
                // åŠ è½½åˆå§‹æ•°æ®
                loadInitialData();
                
                showStatus('æ‰€æœ‰çƒ­åŠ›å›¾ç»„ä»¶åˆå§‹åŒ–æˆåŠŸï¼', 'success');
                
            } catch (error) {
                showStatus('åˆå§‹åŒ–å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        function loadInitialData() {
            // åŠ è½½å…¨æ™¯æ•°æ®
            loadPanoramicData();
            
            // åŠ è½½è¡Œä¸šæ•°æ®
            loadSectorData('ç§‘æŠ€');
            
            // åŠ è½½æ ‡ç­¾æ•°æ®
            loadTagData('äººå·¥æ™ºèƒ½');
            
            // åŠ è½½ç´§å‡‘å‹æ•°æ®
            loadCompactData('gainers');
            
            // åŠ è½½è¿·ä½ æ•°æ®
            loadMiniData();
        }
        
        // å…¨æ™¯çƒ­åŠ›å›¾ç›¸å…³å‡½æ•°
        function loadPanoramicData() {
            if (panoramicHeatmap) {
                panoramicHeatmap.loadMarketData();
                showStatus('æ­£åœ¨åŠ è½½å…¨æ™¯å¸‚åœºæ•°æ®...', 'success');
            }
        }
        
        function changePanoramicMetric(metric) {
            if (panoramicHeatmap) {
                panoramicHeatmap.updateMetric(metric);
                showStatus(`åˆ‡æ¢åˆ°æŒ‡æ ‡: ${metric}`, 'success');
            }
        }
        
        function exportPanoramic() {
            if (panoramicHeatmap) {
                panoramicHeatmap.exportAsImage('panoramic-heatmap.png');
                showStatus('æ­£åœ¨å¯¼å‡ºå…¨æ™¯çƒ­åŠ›å›¾...', 'success');
            }
        }
        
        // è¡Œä¸šçƒ­åŠ›å›¾ç›¸å…³å‡½æ•°
        function loadSectorData(sector) {
            if (sectorHeatmap) {
                sectorHeatmap.loadSectorData(sector);
                showStatus(`æ­£åœ¨åŠ è½½${sector}è¡Œä¸šæ•°æ®...`, 'success');
            }
        }
        
        function refreshSector() {
            if (sectorHeatmap) {
                sectorHeatmap.refresh();
                showStatus('æ­£åœ¨åˆ·æ–°è¡Œä¸šæ•°æ®...', 'success');
            }
        }
        
        // æ ‡ç­¾çƒ­åŠ›å›¾ç›¸å…³å‡½æ•°
        function loadTagData(tag) {
            if (tagHeatmap) {
                tagHeatmap.loadTagData(tag);
                showStatus(`æ­£åœ¨åŠ è½½${tag}æ ‡ç­¾æ•°æ®...`, 'success');
            }
        }
        
        function refreshTag() {
            if (tagHeatmap) {
                tagHeatmap.refresh();
                showStatus('æ­£åœ¨åˆ·æ–°æ ‡ç­¾æ•°æ®...', 'success');
            }
        }
        
        // ç´§å‡‘å‹çƒ­åŠ›å›¾ç›¸å…³å‡½æ•°
        function loadCompactData(type) {
            if (compactHeatmap1 && compactHeatmap2) {
                if (type === 'gainers') {
                    compactHeatmap1.loadTrendingData('gainers');
                    compactHeatmap2.loadTrendingData('losers');
                } else if (type === 'losers') {
                    compactHeatmap1.loadTrendingData('losers');
                    compactHeatmap2.loadTrendingData('active');
                } else {
                    compactHeatmap1.loadTrendingData('active');
                    compactHeatmap2.loadTrendingData('gainers');
                }
                showStatus(`æ­£åœ¨åŠ è½½${type}æ•°æ®...`, 'success');
            }
        }
        
        // è¿·ä½ çƒ­åŠ›å›¾ç›¸å…³å‡½æ•°
        function loadMiniData() {
            if (miniHeatmap1 && miniHeatmap2 && miniHeatmap3) {
                miniHeatmap1.loadSectorData('ç§‘æŠ€');
                miniHeatmap2.loadSectorData('é‡‘è');
                miniHeatmap3.loadSectorData('åŒ»ç–—');
                showStatus('æ­£åœ¨åŠ è½½è¿·ä½ çƒ­åŠ›å›¾æ•°æ®...', 'success');
            }
        }
        
        function toggleMiniAnimation() {
            // è¿™é‡Œå¯ä»¥å®ç°åŠ¨ç”»åˆ‡æ¢é€»è¾‘
            showStatus('åŠ¨ç”»æ•ˆæœå·²åˆ‡æ¢', 'success');
        }
        
        // çŠ¶æ€æ˜¾ç¤ºå‡½æ•°
        function showStatus(message, type = 'success') {
            const container = document.getElementById('status-container');
            const statusDiv = document.createElement('div');
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
            
            container.appendChild(statusDiv);
            
            // 3ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                if (statusDiv.parentNode) {
                    statusDiv.parentNode.removeChild(statusDiv);
                }
            }, 3000);
        }
        
        // ç›‘å¬ç»„ä»¶äº‹ä»¶
        document.addEventListener('heatmap:renderComplete', function(event) {
            console.log('çƒ­åŠ›å›¾æ¸²æŸ“å®Œæˆ:', event.detail);
        });
        
        document.addEventListener('heatmap:error', function(event) {
            showStatus('çƒ­åŠ›å›¾é”™è¯¯: ' + event.detail.message, 'error');
        });
    </script>
</body>
</html>